<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>–í–∏–¥–µ–æ –Ω–∞ —Ñ–æ–Ω–µ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        html, body {
            width: 100%;
            height: 100%;
            overflow: hidden;
            background: #000;
            position: fixed;
        }
        
        #video-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            overflow: hidden;
            background: #000;
            z-index: 1;
        }
        
        video {
            position: absolute;
            top: 50%;
            left: 50%;
            min-width: 100%;
            min-height: 100%;
            width: auto;
            height: auto;
            transform: translate(-50%, -50%);
            object-fit: cover;
            background: #000;
        }
        
        #tap-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 10000;
            cursor: pointer;
            font-family: Arial, sans-serif;
        }
        
        #tap-overlay.hidden {
            display: none;
        }
        
        .tap-message {
            color: #fff;
            font-size: 24px;
            font-weight: 600;
            text-align: center;
            padding: 30px 40px;
            background: rgba(0, 255, 0, 0.2);
            border: 3px solid #00ff00;
            border-radius: 15px;
            user-select: none;
            -webkit-user-select: none;
        }
        
        .tap-icon {
            font-size: 64px;
            margin-bottom: 20px;
        }
        
        /* –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏ */
        .loading-spinner {
            display: none;
            width: 60px;
            height: 60px;
            border: 4px solid rgba(255, 255, 255, 0.3);
            border-top: 4px solid #00ff00;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-top: 30px;
        }
        
        .loading-spinner.active {
            display: block;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* –°–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ */
        .error-message {
            display: none;
            color: #ff4444;
            font-size: 16px;
            margin-top: 20px;
            padding: 15px;
            background: rgba(255, 68, 68, 0.1);
            border: 2px solid #ff4444;
            border-radius: 10px;
            max-width: 80%;
        }
        
        .error-message.active {
            display: block;
        }
    </style>
</head>
<body>
    <div id="tap-overlay">
        <div class="tap-icon">‚ñ∂Ô∏è</div>
        <div class="tap-message" id="tap-text">
            –ù–∞–∂–º–∏—Ç–µ –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –≤–∏–¥–µ–æ
        </div>
        <div class="loading-spinner" id="loading"></div>
        <div class="error-message" id="error-msg"></div>
    </div>

    <div id="video-container">
        <video 
            id="bg-video"
            muted
            playsinline
            webkit-playsinline
            loop
            preload="auto"
        >
            <source src="background.mp4" type="video/mp4">
        </video>
    </div>

    <script>
        const video = document.getElementById('bg-video');
        const overlay = document.getElementById('tap-overlay');
        const tapText = document.getElementById('tap-text');
        const loading = document.getElementById('loading');
        const errorMsg = document.getElementById('error-msg');
        
        let clicked = false;
        
        console.log('üöÄ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è...');
        console.log('üìπ –ü—É—Ç—å –∫ –≤–∏–¥–µ–æ:', video.querySelector('source').src);
        
        // –°—Ä–∞–∑—É –Ω–∞—á–∏–Ω–∞–µ–º –∑–∞–≥—Ä—É–∂–∞—Ç—å –≤–∏–¥–µ–æ
        video.load();
        
        function showError(message) {
            console.error('‚ùå', message);
            tapText.style.display = 'none';
            loading.classList.remove('active');
            errorMsg.textContent = message;
            errorMsg.classList.add('active');
            
            // –î–µ–ª–∞–µ–º overlay –∫–ª–∏–∫–∞–±–µ–ª—å–Ω—ã–º –¥–ª—è –ø–æ–≤—Ç–æ—Ä–∞
            setTimeout(() => {
                errorMsg.innerHTML = message + '<br><br>–ù–∞–∂–º–∏—Ç–µ –¥–ª—è –ø–æ–≤—Ç–æ—Ä–∞';
                clicked = false;
            }, 1000);
        }
        
        function startVideo() {
            if (clicked) return;
            clicked = true;
            
            console.log('üëÜ –ü–æ–ø—ã—Ç–∫–∞ –∑–∞–ø—É—Å–∫–∞ –≤–∏–¥–µ–æ...');
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏
            tapText.textContent = '–ó–∞–≥—Ä—É–∑–∫–∞...';
            loading.classList.add('active');
            errorMsg.classList.remove('active');
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –∑–∞–≥—Ä—É–∂–µ–Ω–æ –ª–∏ –≤–∏–¥–µ–æ
            console.log('üìä ReadyState:', video.readyState);
            console.log('üìä NetworkState:', video.networkState);
            
            // –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–∞—è –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞
            video.load();
            
            // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
            video.muted = true;
            video.volume = 0;
            video.defaultMuted = true;
            
            // –ü—Ä–æ–±—É–µ–º –∑–∞–ø—É—Å—Ç–∏—Ç—å
            const playPromise = video.play();
            
            if (playPromise !== undefined) {
                playPromise
                    .then(() => {
                        console.log('‚úÖ –í–∏–¥–µ–æ –∑–∞–ø—É—â–µ–Ω–æ —É—Å–ø–µ—à–Ω–æ!');
                        overlay.classList.add('hidden');
                    })
                    .catch(error => {
                        console.error('‚ùå –û—à–∏–±–∫–∞ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è:', error);
                        showError('–û—à–∏–±–∫–∞: ' + error.message);
                    });
            }
        }
        
        // –°–æ–±—ã—Ç–∏—è –≤–∏–¥–µ–æ
        video.addEventListener('loadstart', function() {
            console.log('üì• –ù–∞—á–∞–ª–æ –∑–∞–≥—Ä—É–∑–∫–∏ –≤–∏–¥–µ–æ');
        });
        
        video.addEventListener('loadedmetadata', function() {
            console.log('üìπ –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã');
            console.log('‚è±Ô∏è –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:', video.duration, '—Å–µ–∫');
            console.log('üìê –†–∞–∑–º–µ—Ä:', video.videoWidth, 'x', video.videoHeight);
        });
        
        video.addEventListener('loadeddata', function() {
            console.log('üìä –î–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã, ReadyState:', video.readyState);
        });
        
        video.addEventListener('canplay', function() {
            console.log('‚úÖ –í–∏–¥–µ–æ –≥–æ—Ç–æ–≤–æ –∫ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—é');
        });
        
        video.addEventListener('canplaythrough', function() {
            console.log('‚úÖ –í–∏–¥–µ–æ –ø–æ–ª–Ω–æ—Å—Ç—å—é –±—É—Ñ–µ—Ä–∏–∑–æ–≤–∞–Ω–æ');
        });
        
        video.addEventListener('playing', function() {
            console.log('‚ñ∂Ô∏è –í–∏–¥–µ–æ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç—Å—è');
            overlay.classList.add('hidden');
        });
        
        video.addEventListener('error', function(e) {
            const error = video.error;
            let errorText = '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞';
            
            if (error) {
                switch(error.code) {
                    case 1:
                        errorText = '–ó–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–µ—Ä–≤–∞–Ω–∞';
                        break;
                    case 2:
                        errorText = '–û—à–∏–±–∫–∞ —Å–µ—Ç–∏';
                        break;
                    case 3:
                        errorText = '–û—à–∏–±–∫–∞ –¥–µ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è';
                        break;
                    case 4:
                        errorText = '–í–∏–¥–µ–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ –∏–ª–∏ —Ñ–æ—Ä–º–∞—Ç –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è';
                        break;
                }
                console.error('üí• –û—à–∏–±–∫–∞ –≤–∏–¥–µ–æ (–∫–æ–¥ ' + error.code + '):', errorText);
                console.error('üí• –°–æ–æ–±—â–µ–Ω–∏–µ:', error.message);
            }
            
            showError(errorText);
        });
        
        video.addEventListener('stalled', function() {
            console.warn('‚ö†Ô∏è –ó–∞–≥—Ä—É–∑–∫–∞ –æ—Å—Ç–∞–Ω–æ–≤–∏–ª–∞—Å—å');
        });
        
        video.addEventListener('waiting', function() {
            console.log('‚è≥ –ë—É—Ñ–µ—Ä–∏–∑–∞—Ü–∏—è...');
        });
        
        video.addEventListener('pause', function() {
            if (clicked && !document.hidden) {
                console.log('‚è∏Ô∏è –í–∏–¥–µ–æ –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ, –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫...');
                video.play().catch(err => console.error('–ù–µ —É–¥–∞–ª–æ—Å—å –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å:', err));
            }
        });
        
        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–ª–∏–∫–æ–≤
        overlay.addEventListener('click', startVideo);
        overlay.addEventListener('touchstart', startVideo, { passive: true });
        
        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫–∞
        document.addEventListener('DOMContentLoaded', function() {
            console.log('üì± User Agent:', navigator.userAgent);
            console.log('üåê –ë—Ä–∞—É–∑–µ—Ä:', 
                /yabrowser/i.test(navigator.userAgent) ? '–Ø–Ω–¥–µ–∫—Å' :
                /chrome/i.test(navigator.userAgent) ? 'Chrome' :
                /safari/i.test(navigator.userAgent) ? 'Safari' :
                '–î—Ä—É–≥–æ–π'
            );
        });
        
        // –í–æ–∑–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–∏ –≤–æ–∑–≤—Ä–∞—Ç–µ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É
        document.addEventListener('visibilitychange', function() {
            if (!document.hidden && clicked) {
                console.log('üëÅÔ∏è –°—Ç—Ä–∞–Ω–∏—Ü–∞ —Å–Ω–æ–≤–∞ –≤–∏–¥–∏–º–∞');
                video.play().catch(err => console.error('–û—à–∏–±–∫–∞:', err));
            }
        });
        
        // –ü—Ä–æ–≤–µ—Ä–∫–∞ —á–µ—Ä–µ–∑ 3 —Å–µ–∫—É–Ω–¥—ã –ø–æ—Å–ª–µ –ø–æ–ø—ã—Ç–∫–∏ –∑–∞–ø—É—Å–∫–∞
        setTimeout(() => {
            if (clicked && video.paused) {
                console.error('‚ö†Ô∏è –í–∏–¥–µ–æ –Ω–µ –∑–∞–ø—É—Å—Ç–∏–ª–æ—Å—å –∑–∞ 3 —Å–µ–∫—É–Ω–¥—ã');
                showError('–í–∏–¥–µ–æ –Ω–µ —É–¥–∞–ª–æ—Å—å –∑–∞–ø—É—Å—Ç–∏—Ç—å. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ñ–∞–π–ª background.mp4');
            }
        }, 3000);
    </script>
</body>
</html>
